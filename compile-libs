#!/bin/sh
components="pl32-memory pl32-math"
ext="c"
lib="libpl32"

cd build
mkdir obj -p
pwd

case $1 in
	shared)
		for i in $components; do
			echo "Compiling $i component..."
			gcc -I../include -c -fPIC ../src/$i.$ext -o obj/$i.o
		done

		echo "Linking components into $lib.so"
		gcc -shared -o "$lib.so" obj/*.o
		;;

	static)
		for i in $components; do
			echo "Compiling $i component (static)..."
			gcc -I../include -c ../src/$i.$ext -o obj/$i.o
		done

		echo "Packaging components into libpl32engine.a..."
		ar rc "$lib.a" obj/*.o
		;;
esac
